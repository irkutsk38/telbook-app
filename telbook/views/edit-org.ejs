<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Редактировать организацию</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <header><h1>Редактировать организацию</h1></header>
  <main>
    <form method="POST" action="/edit-org/<%= org.org_id %>" id="orgForm">
      <input name="org_name" value="<%= org.org_name %>" placeholder="Название" required>
      <input name="streetname" value="<%= org.streetname %>" placeholder="Улица" required>
      <input name="homenumber" value="<%= org.homenumber %>" placeholder="Дом" required>
      <input name="building" value="<%= org.building || '' %>" placeholder="Корпус">
      <input name="office" value="<%= org.office || '' %>" placeholder="Офис">
      <select name="city_id" required>
        <% cities.forEach(c => { %>
          <option value="<%= c.city_id %>" <%= (c.city_id == org.city_id) ? 'selected' : '' %>><%= c.city_name %></option>
        <% }) %>
      </select>
      <select name="category_id" required>
        <% categories.forEach(cat => { %>
          <option value="<%= cat.category_id %>" <%= (cat.category_id == org.category_id) ? 'selected' : '' %>><%= cat.category_name %></option>
        <% }) %>
      </select>

      <div id="phones">
        <% if (org.phones) { %>
          <% org.phones.split(',').forEach((p, i) => { %>
            <input name="phones" value="<%= p.trim() %>" placeholder="Телефон <%= i+1 %>">
          <% }) %>
        <% } else { %>
          <input name="phones" placeholder="Телефон 1">
        <% } %>
      </div>
      <button type="button" onclick="addPhone()">+ Телефон</button>
      <button>Сохранить</button>
      <a href="/">Отмена</a>
    </form>

    <script>
      function addPhone() {
        const div = document.getElementById('phones');
        const input = document.createElement('input');
        input.name = 'phones';
        input.placeholder = 'Телефон';
        input.style.margin = '4px';
        div.appendChild(input);
      }
    </script>
  </main>
</body>
</html>